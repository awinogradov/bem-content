# popup

Блок `popup` используется для создания выпадающих элементов и позволяет изменять их состояние, поведение и внешний вид. Блок всегда отображается поверх остальных элементов страницы.

Попап может быть вызван различными элементами страницы, например, кнопками или псевдоссылками.

При первом открытии попапа DOM-элемент блока переносится в конце `<body>`. Блок получает модификатор `visible`.

## Инициализация блока

Чтобы попап отображался при установке модификатора `visible`, блок должен быть предварительно инициализирован. Для этого служит метод `setTarget`. В ходе выполнения методу необходимо определить положение попапа на странице. Это может осуществляться:

* исходя из положения на странице родительского элемента. В этом случае методу `setTarget` следует передать аргументом родительский DOM-элемент или БЭМ-блок;
* путем явного указания координат. Первым аргументом методу `setTarget` передается значение отступа от левого края страницы, вторым отступ сверху: `setTarget(x-coordinate, y-coordinate)`.

Метод `setTarget` возвращает объект `this`.

## Модификаторы блока

### Темы `_theme`

Блок представлен в следующих темах:

 * simple
 * normal

Без указания модификатора `theme` отображается [нативный](#native) вид контрола.

Наглядно видно на примерах ниже:

<a name="native"></a>
**default**

```bemjson
{
    block : 'popup',
    content : 'default'
}
```

**simple**

```bemjson
{
    block : 'popup',
    mods : { theme : 'simple' },
    content : 'simple'
}
```

**normal**

```bemjson
{
    block : 'popup',
    mods : { theme : 'normal' },
    content : 'normal'
}
```

### Видимый `_visible`

Модификатор `visible` выставляется блоку автоматически при открытии попапа. Когда попап скрыт, модификатор удаляется.

#### `_autoscalable`

Модификатор `autoscalable` скрывает блок по щелчку мыши вне зоны попапа.

```bemjson
{
    block : 'popup',
    mods : { theme : 'normal', autoclosable : true },
    content : 'normal'
}
```

### Расположение относительно родителя `_direction`

Модификатор `direction` управляет направлением открытия попапа на странице относительно вызвавшего его элемета. Расположение блока определяется автоматически, исходя из массива допустимых направлений и положения родителя на странице.

По умолчанию используется следующий массив допустимых направлений:

* bottom-left
* bottom-center
* bottom-right
* top-left
* top-center
* top-right
* right-top
* right-center
* right-bottom
* left-top
* left-center
* left-bottom

Чтобы управлять расположением попапа, можно ограничить массив направлений открытия, оставив только требуемые. Пользовательский массив нужно передать в качестве JS-параметра с ключом `directions`. При этом из значений массива будет выбрано наиболее подходящее, исходя из положения родителя на странице.

Например, если требуется, чтобы попап раскрывался над родителем:

```bemjson
{
    block : 'popup',
    mods : { autoclosable : true, theme: 'simple' },
    directions : ['top-left', 'top-center', 'top-right'],
    content : 'Hello, world!'
}
```

Или небходимо разместить попап справа по центру:

```bemjson
{
    block : 'popup',
    mods : { autoclosable : true, theme: 'simple' },
    directions : ['right-center'],
    content : 'Hello, world!'
}
```

## Взаимосвязи между popup'ами

Блок `popup` поддерживает вложенную структуру нескольких одновременно открытых попапов. Это означает, что один попап может вызывать второй, второй, соответственно, может вызвать третий и так далее. И при этом все попапы будут оставаться открытыми.

Если установлен модификатор `autoscalable` в значении `true`, то при щелчке мышью вне зоны попапа, попап закроется сам и закроет свои дочерние блоки.

Дочерние блоки popup можно рассматривать в виде цепочки `1` → `2` → `3` → `4`. При клике на втором попапе – закрываются третий и четвертый. При клике в первом – закрываются второй, третий, четвертый. При клике за пределами любого попапа из цепочки – закроются все.
